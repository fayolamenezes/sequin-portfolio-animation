<style>
  .carousel-wrapper {
    width: 100%;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
  }

  .carousel {
    width: 100%;
    height: 100%;
    overflow: hidden;
    position: relative;
  }

  .carousel-inner {
    display: flex;
    flex-direction: row;
    align-items: center;
    height: 100%;
    width: auto;
  }

  .card {
    width: 200px;
    height: 350px;
    flex-shrink: 0;
    margin: 0 5px;
  }

  .c1 { background: #5a1010; }
  .c2 { background: #0b2b40; }
  .c3 { background: #6a5a0e; }
  .c4 { background: #062b10; }
  .c5 { background: #24084a; }
</style>

<div class="carousel-wrapper">
  <div class="carousel" id="carousel">
    <div class="carousel-inner"></div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ModifiersPlugin.min.js"></script>
<script>
  gsap.registerPlugin(ModifiersPlugin);
  const container = document.querySelector('.carousel-inner');
  const cardClasses = ['c1', 'c2', 'c3', 'c4', 'c5'];
  const totalSets = 10;

  for (let i = 0; i < totalSets; i++) {
    cardClasses.forEach(cls => {
      const card = document.createElement('div');
      card.className = `card ${cls}`;
      container.appendChild(card);
    });
  }

  const totalWidth = container.scrollWidth;
  gsap.set(container, { x: -totalWidth / 2 });

  let autoAnim = null;
  let direction = -1;
  let isDragging = false;
  let startX = 0;
  let velocity = 0;
  let lastDelta = 0;
  let rafID;

  const wrapX = x => {
    let val = parseFloat(x) % totalWidth;
    return val > 0 ? val - totalWidth : val;
  };

  const startAutoScroll = () => {
    if (autoAnim) autoAnim.kill();
    autoAnim = gsap.to(container, {
      x: `${direction === -1 ? '-=' : '+='}${totalWidth}`,
      duration: 100,
      ease: 'none',
      repeat: -1,
      modifiers: {
        x: gsap.utils.unitize(wrapX)
      }
    });
  };

  startAutoScroll();

  const updateDrag = () => {
    if (!isDragging) return;
    const x = gsap.getProperty(container, 'x') || 0;
    let newX = wrapX(x + lastDelta);
    gsap.set(container, { x: newX });
    velocity = lastDelta;
    lastDelta = 0;
    rafID = requestAnimationFrame(updateDrag);
  };

  const startDrag = e => {
    isDragging = true;
    startX = e.touches ? e.touches[0].clientX : e.clientX;
    if (autoAnim) autoAnim.pause();
    cancelAnimationFrame(rafID);
    rafID = requestAnimationFrame(updateDrag);
  };

  const drag = e => {
    if (!isDragging) return;
    const currentX = e.touches ? e.touches[0].clientX : e.clientX;
    lastDelta = currentX - startX;
    startX = currentX;
  };

  const endDrag = () => {
    isDragging = false;
    cancelAnimationFrame(rafID);
    direction = velocity < 0 ? -1 : 1;
    gsap.to(container, {
      x: `+=${velocity * 20}`,
      duration: 1,
      ease: "power2.out",
      modifiers: { x: gsap.utils.unitize(wrapX) },
      onComplete: startAutoScroll
    });
  };

  const el = document.querySelector('.carousel');
  el.addEventListener('mousedown', startDrag);
  el.addEventListener('mousemove', drag);
  el.addEventListener('mouseup', endDrag);
  el.addEventListener('mouseleave', endDrag);
  el.addEventListener('touchstart', startDrag);
  el.addEventListener('touchmove', drag);
  el.addEventListener('touchend', endDrag);
</script>
